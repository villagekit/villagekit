Ruby style blocks

Base math: `math.rimu`

```
export
  Vector3
  Quaternion
end

struct Vector3
  input x: Num of
    default = 0
  end

  input y: Num of
    default = 0
  end

  input z: Num of
    default = 0
  end

  function length
    input self
    output Num
  do
    let { x, y, z } = self
    sqrt(x * x, y * y, z * z)
  end
end


struct Quaternion
  input x: Num of
    default = 0
  end

  input y: Num of
    default = 0
  end

  input z: Num of
    default = 0
  end

  input z: Num of
    default = 1
  end
```

3d object trait: `object-3d.rimu`

```
import
  with @std/math
    Vector3
    Quaternion
  end
end

export Object3d

struct Transform
  input translation: Vector3

  input rotation: Quaternion

  input scale: Vector3

  function translate
    input self
    input x: Num
    input y: Num
    input z: Num
    output Self
  do
    Self of
      ...self
      translation = Vector3
        self.translation.x + x
        self.translation.y + y
        self.translation.z + z
    end
  end
end

trait Object3d
  input transform: Transform

  function translate
    input self
    input Num
    input Num
    input Num
    output Self
  do
    Self of
      ...self
      transform: self.transform.translate(x, y, z)
    end
  end
end
```

Assembly trait: `assembly.rimu`

```
import
  Object3d = @std/object-3d
end

export Assembly

type Part = Union of
  Stock
  Assembly
end

type Parts = List of
  default = []
  item = Union of
    Parts
    Part
    Null
  end
end

trait Assembly
  impl Object3d

  function parts: Parts
end
```


Example assembly: `chair.rimu`

```
import
  Assembly = @std/assembly@1
  GridBeam = @villagekit/gridbeam@1
  SmartFasteners = @villagekit/smart-fasteners@1
end

export Chair

struct Chair
  input seat_width: Num of
    label = 'Seat width'
    min = 5
    max = 10
    step = 5
  end

  input seat_depth: Num of
    label = 'Seat depth'
    min = 5
    max = 15
  end

  input seat_height: Num of
    label = 'Seat height'
    description = 'The height from the ground to the top of the seat'
    min = 5
    max = 15
  end

  input should_include_back: Bool of
    label = 'Include back'
  end

  input back_height: Num of
    label = 'Back height'
    description = 'The height from the seat to the top of the backrest'
    requires = function
      input self
    do
      self.should_include_back
    end
    min = 5
    max = 10
  end

  function regular
    input self
    output Self
  do
    meta label = 'Regular (Without Back)'

    Self of
      back_height = 10
      seat_depth = 10
      seat_height = 10
      seat_width = 10
      should_include_back = false
    end
  end

  function regular_with_back
    input self
    output Self
  do
    meta label = 'Regular With Back'

    Self of
      ...Self.regular()
      should_include_back = true
    end
  end

  const plugins = [SmartFasteners()]

  impl Assembly
    function parts
      input self
    do
      let with self
        seat_width
        seat_depth
        seat_height
        back_height
        should_include_back
      end

      let back_z_beam_end_z = if should_include_back then seat_height + back_height else seat_height
      let seat_panel_start_y = if should_include_back then -1 else 0
      let seat_panel_end_y = if should_include_back then seat_depth - 1 else seat_depth

      List of
        GridPanel.XY of
          x: [0, seat_width]
          y: [seat_panel_start_y, seat_panel_end_y]
          z: seatHeight
        end

        if should_include_back
          GridPanel.XZ of
            x: [0, seat_width]
            y: seat_depth - 2
            z: [seat_height + 1, seat_height + 1 + back_height]
            fit: 'top'
          end
        end

        GridBeam.Z of
          x: 0
          y: 0
          z: [0, seat_height]
        end

        GridBeam.Z of
          x: seat_width - 1
          y: 0
          z: [0, seat_height]
        end

        GridBeam.Z of
          x: 0
          y: seat_depth - 1
          z: [0, back_z_beam_end_z]
        end

        GridBeam.Z of
          x: seat_width - 1
          y: seat_depth - 1
          z: [0, back_z_beam_end_z]
        end

        GridBeam.X of
          x: [0, seat_width]
          y: 1
          z: seat_height - 2
        end

        GridBeam.X of
          x: [0, seat_width]
          y: seat_depth - 2
          z: seat_height - 2
        end

        GridBeam.Y of
          x: 1
          y: [0, seat_depth]
          z: seat_height - 1
        end

        GridBeam.Y of
          x: seat_width - 2
          y: [0, seat_depth]
          z: seat_height - 1
        end
      end
    end
  end
end
```

Renderable struct `renderable.rimu`

```
export Renderable

enum Mesh
  case Cuboid
    x_length: Num
    y_length: Num
    z_length: Num
  end
end

enum Material
  case Color
    color: Color
  end
end

struct Instance
  input mesh: Str
  input material: Str
  input transform: Transform
  input children: List(Self)
end

struct Renderable
  input meshes: Map(Mesh)
  input materials: Map(Material)
  input instances: List(Instance)
end
```

Stock trait: `stock.rimu`

```
import
  Object3d = @std/object-3d
end

export Stock

trait Stock
  impl Object3d

  function render
    input self
    output Renderable
  end
end
```

Example stock part: `gridbeam.rimu`

```
import
  Stock = @std/stock
end

export GridBeam

struct GridBeam
  input length: Num of
    label = "Length"
    description = "The length of the beam in grid units"
  end

  fn X
    input x: [Num, Num]
    input y: Num
    input z: Num
    output Self
  do
    pipe
      Self({ length: abs(x.1 - x.0) })
      _.rotate()
      # ...
    end
  end

  impl Stock
    fn render
      input self
      output Rendable
    do
      # ...
    end
  end
end
```
